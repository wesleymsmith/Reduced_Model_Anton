* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Apr, 24. 2018. JOBID=1524599187
* READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
*

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

! Read PR1A
open read card unit 10 name prot_reduced_vmd_chainter_pr1a.crd
read sequence coor card unit 10 resid
generate PR1A setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr1a.crd
read coor unit 10 card resid


! Read PR1B
open read card unit 10 name prot_reduced_vmd_chainter_pr1b.crd
read sequence coor card unit 10 resid
generate PR1B setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr1b.crd
read coor unit 10 card resid


! Read PR1C
open read card unit 10 name prot_reduced_vmd_chainter_pr1c.crd
read sequence coor card unit 10 resid
generate PR1C setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr1c.crd
read coor unit 10 card resid


! Read PR1D
open read card unit 10 name prot_reduced_vmd_chainter_pr1d.crd
read sequence coor card unit 10 resid
generate PR1D setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr1d.crd
read coor unit 10 card resid


! Read PR2A
open read card unit 10 name prot_reduced_vmd_chainter_pr2a.crd
read sequence coor card unit 10 resid
generate PR2A setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr2a.crd
read coor unit 10 card resid


! Read PR2B
open read card unit 10 name prot_reduced_vmd_chainter_pr2b.crd
read sequence coor card unit 10 resid
generate PR2B setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr2b.crd
read coor unit 10 card resid


! Read PR2C
open read card unit 10 name prot_reduced_vmd_chainter_pr2c.crd
read sequence coor card unit 10 resid
generate PR2C setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr2c.crd
read coor unit 10 card resid


! Read PR2D
open read card unit 10 name prot_reduced_vmd_chainter_pr2d.crd
read sequence coor card unit 10 resid
generate PR2D setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr2d.crd
read coor unit 10 card resid


! Read PR3A
open read card unit 10 name prot_reduced_vmd_chainter_pr3a.crd
read sequence coor card unit 10 resid
generate PR3A setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr3a.crd
read coor unit 10 card resid


! Read PR3B
open read card unit 10 name prot_reduced_vmd_chainter_pr3b.crd
read sequence coor card unit 10 resid
generate PR3B setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr3b.crd
read coor unit 10 card resid


! Read PR3C
open read card unit 10 name prot_reduced_vmd_chainter_pr3c.crd
read sequence coor card unit 10 resid
generate PR3C setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr3c.crd
read coor unit 10 card resid


! Read PR3D
open read card unit 10 name prot_reduced_vmd_chainter_pr3d.crd
read sequence coor card unit 10 resid
generate PR3D setup warn first ACE last CT3

open read unit 10 card name prot_reduced_vmd_chainter_pr3d.crd
read coor unit 10 card resid


!Print heavy atoms with unknown coordinates
coor print sele ( .not. INIT ) .and. ( .not. hydrogen ) end

ic param
ic build
prnlev 0
hbuild sele hydr end 
prnlev 5


ENERGY
! check if there are unknown coordinate
define XXX sele .not. INIT show end
if ?nsel .gt. 0 stop ! ABNORMAL TERMINATION: Undefined coordinates

open write card unit 10 name step1_pdbreader.pdb
write coor pdb  unit 10 official

open write card unit 10 name step1_pdbreader.crd
write coor unit 10 card

open write unit 10 card name step1_pdbreader.psf
write psf  unit 10 card

open write unit 10 card name step1_pdbreader.xplor_ext.psf
write psf  xplo unit 10 card

ioformat noext
open write unit 10 card name step1_pdbreader.xplor.psf
write psf  xplo unit 10 card


coor stat sele all end

calc cgtot = int ( ?cgtot )

open write unit 90 card name step1_pdbreader.str
write title unit 90
* set ncharge = @cgtot
* set xmax = ?xmax
* set ymax = ?ymax
* set zmax = ?zmax
* set xmin = ?xmin
* set ymin = ?ymin
* set zmin = ?zmin
*

stop
